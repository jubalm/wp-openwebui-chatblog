# WordPress-OpenWebUI Integration Plan: Secure Application Password Transfer

This document outlines a plan for securely integrating WordPress with OpenWebUI, allowing OpenWebUI to perform actions on WordPress (e.g., publishing draft posts) using a user-provided WordPress Application Password. The core principle is to ensure the Application Password is never exposed client-side during transfer.

## 1. Overview

The integration will involve a custom WordPress plugin and a new API endpoint within OpenWebUI. The user will generate an Application Password in WordPress, paste it into the WordPress plugin's settings, and the plugin will securely transmit it to OpenWebUI's backend. OpenWebUI will then store this password, associated with the SSO-authenticated user, for future API calls to WordPress.

## 2. WordPress Plugin Development

A new custom WordPress plugin will be developed with the following components:

### 2.1. User Interface
-   **Settings Page:** Create a dedicated settings page within the WordPress admin dashboard for the plugin.
-   **Instructions:** Provide clear, step-by-step instructions for the user on how to generate a WordPress Application Password (e.g., "Go to Users > Profile, scroll down to 'Application Passwords', create a new one, and copy the generated password.").
-   **Input Field:** Include a secure input field (e.g., `type="password"`) where the user can paste their generated Application Password.
-   **Submit Button:** A button to trigger the submission of the form.

### 2.2. Server-Side Logic (PHP)
-   **Form Handling:** When the user submits the form, the plugin's PHP code will intercept the submission.
-   **Secure POST Request:** The plugin will make a **server-side HTTP POST request** to a designated API endpoint on the OpenWebUI backend.
    -   **Endpoint URL:** The OpenWebUI API endpoint URL will need to be configurable within the WordPress plugin (e.g., via a constant or another setting).
    -   **Payload:** The request body will contain the WordPress Application Password.
    -   **Authentication (Plugin to OpenWebUI):** To secure this server-to-server communication, consider:
        -   **Pre-shared API Key:** A unique API key generated by OpenWebUI and configured in the WordPress plugin. This key would be sent in a custom HTTP header (e.g., `X-OpenWebUI-API-Key`).
        -   **Temporary Token:** OpenWebUI could expose a lightweight endpoint to generate a short-lived token that the WordPress plugin requests first, then uses to authenticate the Application Password submission.
    -   **HTTPS:** Ensure the POST request is made over HTTPS to encrypt the data in transit.
-   **Error Handling:** Implement robust error handling for the POST request (e.g., network issues, OpenWebUI API errors).
-   **Redirection:** Upon successful submission to OpenWebUI, redirect the user's browser to a specific OpenWebUI page (e.g., a confirmation page or the main settings page), leveraging the existing SSO for seamless login.

## 3. OpenWebUI Backend Development

Modifications to the OpenWebUI backend will include:

### 3.1. New API Endpoint
-   **Endpoint Definition:** Create a new, dedicated API endpoint (e.g., `/api/wordpress/application-password`) that accepts POST requests.
-   **Authentication/Authorization:** This endpoint must be secured:
    -   **Plugin Authentication:** Validate the API key or temporary token sent by the WordPress plugin.
    -   **User Association:** Crucially, ensure the request is associated with the currently SSO-authenticated OpenWebUI user. This means the endpoint should likely be accessible only to authenticated OpenWebUI users, and the received Application Password will be linked to their user profile.
-   **Input Validation:** Validate the received Application Password (e.g., format, length).

### 3.2. Secure Storage
-   **Encryption:** The received WordPress Application Password **must be encrypted** before storage in OpenWebUI's database. Use a strong, industry-standard encryption algorithm (e.g., AES-256) with a securely managed encryption key.
-   **Database Storage:** Store the encrypted Application Password in the OpenWebUI database, linked to the specific OpenWebUI user.

### 3.3. Usage of Application Password
-   **Decryption on Demand:** When OpenWebUI needs to interact with WordPress (e.g., to publish a draft post), it will retrieve the encrypted password from its database, decrypt it, use it for the WordPress API call, and then discard the decrypted value from memory.
-   **WordPress API Client:** Implement or extend an internal WordPress API client within OpenWebUI that utilizes this stored Application Password for authentication with the WordPress REST API.

## 4. Security Considerations

-   **HTTPS Everywhere:** All communication (user browser to WordPress, WordPress plugin to OpenWebUI backend, OpenWebUI to WordPress REST API) must use HTTPS.
-   **No Client-Side Exposure:** The WordPress Application Password must never be exposed in client-side code, URLs, or browser storage.
-   **Secure Key Management:** The encryption key used by OpenWebUI to store the Application Passwords must be securely managed (e.g., environment variables, secret management service).
-   **Least Privilege:** The WordPress Application Password should only have the minimum necessary permissions in WordPress (e.g., `edit_posts` for publishing drafts).
-   **Input Validation & Sanitization:** Rigorously validate and sanitize all inputs on both the WordPress and OpenWebUI sides to prevent injection attacks.
-   **Error Logging:** Implement secure logging for errors without exposing sensitive information.

## 5. Future Enhancements

-   **Application Password Revocation:** Consider adding functionality in OpenWebUI to allow users to revoke their stored WordPress Application Password.
-   **Multiple WordPress Instances:** If a user has multiple WordPress blogs, extend the system to allow storing multiple Application Passwords, each linked to a specific WordPress instance.
-   **User Feedback:** Provide clear feedback to the user in OpenWebUI after the password has been successfully stored and the integration is active.
